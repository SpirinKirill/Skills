# Работа дял школы 
## Задача
Смоделировать изменение балансов студентов.
Чтобы проверить, всё ли в порядке с данными, важно понимать: 
- сколько всего уроков было на балансе всех учеников за каждый календарный день;
- как это количество менялось под влиянием транзакций (оплат, начислений, корректирующих списаний) и
уроков (списаний с баланса по мере прохождения уроков).
Также создать таблицу, где будут балансы каждого студента за каждый день.

Задание 1

Посмотрите на изменения балансов студентов (на примере топ-1000 строк), собранных из CTE.
Какие данные вас смущают?  

Задание 2

Создайте визуализацию (линейную диаграмму) итогового результата. 

## Ход работы
1. Узнаем, когда была первая транзакция для каждого студента. Начиная с этой даты, мы будем собирать его баланс уроков.
2. Соберем таблицу с датами за каждый календарный день 2016 года.
3. Узнаем, за какие даты имеет смысл собирать баланс для каждого студента.
4. Найдем все изменения балансов, связанные с успешными транзакциями.
5. Найдем баланс студентов, который сформирован только транзакциями.
6. Найдем изменения балансов из-за прохождения уроков.
7. По аналогии с уже проделанным шагом для оплат создадим CTE для хранения кумулятивной суммы количества пройденных уроков.
8. Создадим CTE с вычисленными балансами каждого студента.
9. Посмотрим, как менялось общее количество уроков на балансах студентов.
